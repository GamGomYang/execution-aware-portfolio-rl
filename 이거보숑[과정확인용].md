현재  Gate1 후보 9~10개 “일괄 스윕” 실행 진행중

해당 스윕을 통해 gate1 확보 하려고 함 
스윕이(5,6,7) 성공적으로 끝난다면  -> step3으로 이어가기

STEP 6) Gate1 결과 선택(상위 1~2개만 Gate2로 승격)
선택 규칙(강제):
- PASS 후보 중 Score 상위 1~2개만 승격
- PASS가 0개면:
  - “턴오버는 줄었는데 샤프가 깨짐” vs “턴오버도 못 줄임”으로 원인을 분리
  - 다음 라운드는 A1(α 더 낮게) / A3(k 더 크게) 쪽을 우선 확장 또는 λ 스케일 재조정

산출물(확정본):
- outputs/exp_runs/gate1/Gate1_leaderboard.csv
- outputs/exp_runs/gate1/gate1_summary.md

────────────────────────────────────────────────────────
STEP 7) (다음 단계 예고) Gate2 준비
Gate2는 “mid-regime 음수”를 잡는 단계이므로,
- Gate1 상위 1~2개에만 B1 multiplier {0.5, 0.7}를 얹어서
- 30k~50k, seeds=3, eval=W1+W2로 진행

────────────────────────────────────────────────────────
지금 바로 실행할 것 한 줄 요약
1) reference baseline 1회 실행(--model-types baseline)
2) 후보 1개 스모크 실행(--model-types prl)
3) build_gate1_leaderboard 실행 → 산출물 3개 생성 확인
4) OK면 9~10개 일괄 스윕으로 확장













------------------------step3-------------------------

STEP 3) Gate2 확증(핵심: mid-regime 음수 문제 제거/완화)
목적:
- 기존 핵심 이슈: mid 구간 Δ가 확실히 음수.
- Gate2는 mid에서 “음수 CI”를 0 근처로 끌어오는지 확인한다.

3-0) Gate2 공통 FAST 설정(강제)
- timesteps: 30k~50k
- seeds: 3
- eval window: W1 + W2 둘 다(멀티 윈도우)
- eval.run_baselines: false
- eval.write_step4: false
- trace: false 또는 stride 크게(필요 시만 최소 저장)

3-1) Gate2 후보 구성(원문 유지, 최대 4개로 제한)
- Gate1 상위 1~2개 설정에 대해 B1/B2를 얹음

B1) Regime-aware Plasticity Schedule
- mid plasticity multiplier ∈ {0.5, 0.7}

B2) Mid-Regime Cost Amplification(선택)
- mid cost multiplier ∈ {1.5, 2.0}

총 후보 수 예:
- (상위 1개) × (B1 2개) = 2개
- (상위 2개) × (B1 2개) = 4개
- B2까지 모두 얹어 폭발시키지 말 것(최대 4개 유지)

3-2) Gate2 통과/탈락 기준(강제)
통과:
- mid Δsharpe_net_exp가 0에 가까워짐(음수 magnitude 감소)
  또는 mid Δcumret_net_exp가 음수→0 근처 이상으로 개선
- bootstrap CI 하한이 “큰 음수”가 아님
  (권장 기준: 하한 >= -0.01, 목표는 -0.005 이상)

탈락:
- mid Δ 지표의 CI 하한이 -0.01 이하로 “명확히 음수”가 지속되는 후보

3-3) Gate2 결과 선택(강제)
- 상위 1~2개만 Gate3로 승격

────────────────────────────────────────────────────────
STEP 4) Gate3 준최종(리스크 정렬로 Sharpe 끌어올리기)
목적:
- Gate2까지는 구조 개선(turnover/mid)을 했고,
- Gate3는 “std 감소” 중심의 risk penalty(C1/C2)로 Sharpe를 올린다.

4-0) Gate3 설정(강제)
- timesteps: 100k
- seeds: 5
- eval window: 전체(가능하면) 또는 최소 W1+W2
- eval.run_baselines: false
- eval.write_step4: false

4-1) 후보 구성(원문 유지, 최소 스윕)
C1) Variance/Downside penalty: β ∈ {0.1, 0.3, 1.0}
또는
C2) CVaR penalty: γ ∈ {0.1, 0.3, 1.0}

규칙:
- C1과 C2를 동시에 풀스윕하지 말 것
- 상위 후보 1개에 대해 2~3점만 먼저 확인

4-2) Gate3 통과 기준(강제)
- Sharpe_net_exp가 의미 있게 상승(+0.2 이상)
- MDD_net_exp 악화 없음(또는 개선)

────────────────────────────────────────────────────────
STEP 5) Gate4 옵션(환경 확장: Cash/Hedge) — “샤프 2”가 멀 때만
진입 조건:
- Gate3까지 갔는데도 Sharpe_net_exp가 1.2~1.4 수준에서 정체

5-1) 우선순위
- D1 Cash weight 추가부터(구현 난이도 대비 효과 큼)
- D2 Hedge asset은 데이터/정합성 준비 후

5-2) 통과 기준(원문 유지)
- Sharpe_net_exp +0.4 이상 개선(환경 확장은 효과가 커야 의미)

────────────────────────────────────────────────────────
STEP 6) Final 최종 확증(여기서만 결론)
목적:
- 논문/결론용 “최종 수치” 확정

6-0) Final 설정(강제)
- 후보 1~2개
- seeds: 10
- timesteps: 250k~500k
- cost: 0.0005 + 0.0010 최소 2점 스윕
- eval window: 전체(2022-02-15~2025-12-30)
- eval.run_baselines: true (전략 baseline 3종 포함)
- eval.write_step4: true (최종 리포트/그래프 생성)
- trace: true(필요 시) 또는 stride 낮게(최종은 저장 권장)

6-1) Final 성공 기준(원문 그대로)
- mean Sharpe_net_exp ≥ 2.0 (seeds≥10)
- 95% CI 하한 목표(예: 1.8 이상)
- MDD_net_exp >= -0.20
- turnover 폭증 제한

────────────────────────────────────────────────────────
STEP 7) 최종 산출물 생성(제출용)
7-1) make_roadmap_report 실행
- 입력: outputs/exp_runs/ 아래 run_index.json 들
- 출력:
  - outputs/reports/roadmap_results.md
  - outputs/reports/final_candidates_table.csv
  - outputs/reports/final_decision.md

7-2) 포함해야 할 핵심(강제)
- Gate별 상위 후보/탈락 사유/핵심 수치
- net_exp를 기본으로, gross는 보조로 병기
- mid-regime 개선 여부를 핵심 근거로 제시
- 비용 스윕 결과(0.0005 vs 0.0010) 임계점 요약

────────────────────────────────────────────────────────
STEP 8) 실패/리스크 대응(즉시 분기)
- Gate1에서 turnover 감소가 전혀 안 나오면:
  -> A1(α 더 낮게) + A3(k 더 크게) 쪽으로 확장, 또는 Δw penalty 스케일 재조정
- Gate2에서 mid 음수 CI가 계속 유지되면:
  -> B1(더 강한 보수화) 우선, B2는 정당화 가능한 수준만
- Gate3에서 Sharpe가 정체하면:
  -> D1(cash)로 전환하거나, 목표를 현실 조정(net 1.5+ 안정) 논문형 플랜 준비